<html>

<head>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
        integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
</head>

<body>
    <div class="row">
        <div class="col">
            <div class="container">
                <div>
                    <canvas id="myChart""></canvas>
                </div>
            </div>
        </div>
    </div>

    <div class=" conteiner">
          <div class=" row">
              <div class="col-7">
                  <div class="form-inline">
                      <div class="form-group mb-2 ml-5 p-3">
                          <label class="my-1 mr-2" for="inlineFormCustomSelectPref">Select
                              Date
                          </label>
                          <select class="custom-select ml-5" id="select">
                              <option selected>Choose.</option>
                          </select>
                          <div class="form-group ml-5 p-3">
                              <label for="" class="sr-only"></label>
                              <input type="text" id="sales_edit" class="form-control">
                          </div>
                          <button class="btn btn-success ml-5" id="update_sales">Update</button>
                      </div>

                  </div>
              </div>
          </div>
    </div>


 <script>
            let myChart
            let data = [{ "id": 1, "date": "Fri Jun 12 2020 14:53:15 GMT+0530", "sales": "₹206982" },
            { "id": 2, "date": "Sat Jun 13 2020 14:53:15 GMT+0530", "sales": "₹117589" },
            { "id": 3, "date": "Sun Jun 14 2020 14:53:15 GMT+0530", "sales": "₹86435" },
            { "id": 4, "date": "Mon Jun 15 2020 14:53:15 GMT+0530", "sales": "₹126552" },
            { "id": 5, "date": "Tue Jun 16 2020 14:53:15 GMT+0530", "sales": "₹64079" },
            { "id": 6, "date": "Wed Jun 17 2020 14:53:15 GMT+0530", "sales": "₹105265" },
            { "id": 7, "date": "Thu Jun 18 2020 14:53:15 GMT+0530", "sales": "₹156243" },
            { "id": 8, "date": "Fri Jun 19 2020 14:53:15 GMT+0530", "sales": "₹146727" },
            { "id": 9, "date": "Sat Jun 20 2020 14:53:15 GMT+0530", "sales": "₹265726" },
            { "id": 10, "date": "Sun Jun 21 2020 14:53:15 GMT+0530", "sales": "₹144392" },
            { "id": 11, "date": "Mon Jun 22 2020 14:53:15 GMT+0530", "sales": "₹86920" },
            { "id": 12, "date": "Tue Jun 23 2020 14:53:15 GMT+0530", "sales": "₹178592" },
            { "id": 13, "date": "Wed Jun 24 2020 14:53:15 GMT+0530", "sales": "₹189293" },
            { "id": 14, "date": "Thu Jun 25 2020 14:53:15 GMT+0530", "sales": "₹285135" },
            { "id": 15, "date": "Fri Jun 26 2020 14:53:15 GMT+0530", "sales": "₹190731" },
            { "id": 16, "date": "Sat Jun 27 2020 14:53:15 GMT+0530", "sales": "₹255364" },
            { "id": 17, "date": "Sun Jun 28 2020 14:53:15 GMT+0530", "sales": "₹136079" },
            { "id": 18, "date": "Mon Jun 29 2020 14:53:15 GMT+0530", "sales": "₹53839" },
            { "id": 19, "date": "Tue Jun 30 2020 14:53:15 GMT+0530", "sales": "₹58374" },
            { "id": 20, "date": "Wed Jul 01 2020 14:53:15 GMT+0530", "sales": "₹58856" },
            { "id": 21, "date": "Thu Jul 02 2020 14:53:15 GMT+0530", "sales": "₹93477" },
            { "id": 22, "date": "Fri Jul 03 2020 14:53:15 GMT+0530", "sales": "₹273749" },
            { "id": 23, "date": "Sat Jul 04 2020 14:53:15 GMT+0530", "sales": "₹244317" },
            { "id": 24, "date": "Sun Jul 05 2020 14:53:15 GMT+0530", "sales": "₹185956" },
            { "id": 25, "date": "Mon Jul 06 2020 14:53:15 GMT+0530", "sales": "₹148110" },
            { "id": 26, "date": "Tue Jul 07 2020 14:53:15 GMT+0530", "sales": "₹229041" },
            { "id": 27, "date": "Wed Jul 08 2020 14:53:15 GMT+0530", "sales": "₹98151" },
            { "id": 28, "date": "Thu Jul 09 2020 14:53:15 GMT+0530", "sales": "₹171087" },
            { "id": 29, "date": "Fri Jul 10 2020 14:53:15 GMT+0530", "sales": "₹99468" },
            { "id": 30, "date": "Sat Jul 11 2020 14:53:15 GMT+0530", "sales": "₹207144" }]

            let records = []
            let res = []
            let sold_data = []
            let changeColor = []

            function fetchData() {

                records.length = 0
                res.length = 0
                sold_data.length = 0
                changeColor.length = 0

                data.forEach(elem => { let x = new Date(elem.date); records.push(x.getDate()); res.push(elem.date) })

                data.forEach(elem => { let x = elem.sales.split("₹"); sold_data.push(Number(x[1])) })

                data.forEach(elem => {
                    let x = elem.sales.split("₹");
                    if (Number(x[1]) > 100000 && Number(x[1]) < 200000) {
                        changeColor.push(`#C6FF00`)
                    }
                    else if (Number(x[1]) > 150000) {
                        changeColor.push(`#FF4081`)
                    }
                    else if (Number(x[1]) <= 100000) {
                        changeColor.push(`#00B0FF`)
                    }
                })
            }


            let createChart = {
                type: "bar",
                data: {
                    labels: records,
                    datasets: [
                        {
                            label: "Sales in Rupees(₹)",
                            data: sold_data,
                            backgroundColor: changeColor,
                            borderColor: "rgb(0, 0, 0)",
                            borderWidth: 1,
                        }
                    ],
                },
                options: {

                    scales: {
                        yAxes: [
                            {
                                ticks: {

                                    beginAtZero: true,

                                },
                                scaleLabel: {
                                    display: true,
                                    labelString: 'Rupees(₹)',
                                    fontSize: 20,
                                }

                            },
                        ],
                        xAxes: [
                            {

                                scaleLabel: {
                                    display: true,
                                    labelString: 'Date',
                                    fontSize: 20,
                                }

                            },
                        ],
                    },


                    title: {
                        display: true,
                        text: "SALES CHART",
                        fontSize: 30

                    },
                    legend: {
                        position: 'top',
                        labels: {
                            fontColor: '#000',
                            backgroundColor: "#2348"
                        }
                    },

                }

            };



            function inputUpdate() {
                let index = Number(event.target.value)
                let value
                data.forEach(elem => { let x = new Date(elem.date); if (index == x.getDate()) { value = elem.sales.split("₹") } })
                document.getElementById("sales_edit").value = value[1]
            }

            function updateSelect() {
                const target = document.getElementById("select")
                target.innerHTML = ""
                let opt1 = document.createElement("option")
                opt1.value = ""
                opt1.textContent = "Choose..."
                let fag = document.createDocumentFragment()
                fag.append(opt1)
                records.forEach((elem, index) => {

                    let opt = document.createElement("option")
                    opt.value = elem
                    opt.textContent = elem
                    fag.append(opt)
                })
                target.append(fag)
            }

            function renderUpdate() {
                let base = document.getElementById("select").value
                let sales_value = document.getElementById("sales_edit").value
                let value
                data.forEach((elem, index) => { let x = new Date(elem.date); if (Number(base) == x.getDate()) { value = index } })
                data[value].sales = "₹" + sales_value
                fetchData()
                myChart.update();
            }

            window.addEventListener("load", function () {

                fetchData()

                let target = document.getElementById("myChart");
                myChart = new Chart(target, createChart);



                let edit = document.getElementById("select")
                edit.addEventListener("change", inputUpdate)
                edit.addEventListener("mouseenter", updateSelect)

                let update = document.getElementById("update_sales")
                update.addEventListener("click", renderUpdate)
            });
        </script>
</body>

</html>